"use strict";angular.module("phosphoBaseApp",["ngCookies","ngResource","ngSanitize","ngRoute","firebase","ph.Elements","ui.bootstrap","ngAnimate"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/docs",{templateUrl:"views/docs.html",controller:"DocsCtrl"}).when("/overview",{templateUrl:"views/overview.html",controller:"OverviewCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("phosphoBaseApp").controller("MainCtrl",["$scope","$rootScope","PhosphoIO","figureFactory","$modal",function(a,b,c,d,e){a.newPathway=new d.pathway,a.open=function(){b.alerts=[],a.modalInstance=e.open({templateUrl:"views/figure-modal.html"})},a.clickItem=function(c,d){d?(b.mutableSelection=!0,b.selectedItem=angular.copy(c)):b.selectedItem=c,a.open()},a.phosphoIO=c,a.figures=a.phosphoIO.$child("figures"),a.figures.$on("loaded",function(){var b=0;angular.forEach(a.figures,function(){b++}),a.figureCount=b-11}),b.addAlert=function(a,c){b.alerts.push({type:a,msg:c})},b.closeAlert=function(b){a.alerts.splice(b,1)},b.fork=function(a){b.parentFigure=a,b.selectedItem=angular.copy(a),b.mutableSelection=!0,b.selectedItem.forks=0},b.publish=function(c){if(!b.auth.user)return void b.addAlert("info","In order to publish, first log-in");if(!c.hasTitle)return void b.addAlert("danger","In order to publish, first edit the title this figure");b.parentFigure,b.mutableSelection=!1,c.flasks=0,c.forks=0;var d=new Date;c.pubDate=d.getTime(),b.auth.user?(c.author=b.auth.user.email,a.figures.$add(c),a.modalInstance.close()):b.addAlert("danger","For some reason, your figure was not published.")},b.displayScale={gridblock:.25,focus:1}}]),angular.module("phosphoBaseApp").controller("DocsCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("phosphoBaseApp").controller("OverviewCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("phosphoBaseApp").controller("LoginCtrl",["$scope","$firebaseSimpleLogin","$rootScope",function(a,b,c){var d=new Firebase("https://phosphobase.firebaseio.com");a.loginObj=b(d),c.$on("$firebaseSimpleLogin:login",function(a,b){c.user={email:b.email}}),c.$on("$firebaseSimpleLogin:logout",function(){c.user=null}),a.loginEmail="test@phospho.io",a.loginPassword="test123",a.login=function(){var b={email:a.loginEmail,password:a.loginPassword};a.loginObj.$login("password",b).then(function(a){console.log("logged in as: ",a.uid)},function(a){console.log("login failed: ",a)})},a.signup=function(){a.loginObj.$createUser(a.signupEmail,a.signupPassword).then(function(a){console.log("Created account and logged in as: ",a.uid)},function(a){console.log("login failed: ",a)})},a.logout=function(){a.loginObj.$logout()}}]),angular.module("phosphoBaseApp").service("PhosphoIO",["$firebase",function(a){var b=new Firebase("https://phosphobase.firebaseio.com");return a(b)}]),angular.module("phosphoBaseApp").factory("figureFactory",function(){var a={title:"Untitled Figure",type:"pathway",graph:{nodes:[{id:0,label:"BCR",type:"prot",compartment:"membrane"},{id:1,label:"PIK3CD",type:"prot",compartment:"cytosol"},{id:2,label:"PIK3R1",type:"prot",compartment:"cytosol"},{id:3,label:"Cell Growth",type:"event",compartment:"nucleus"},{id:4,label:"LYN",type:"prot",compartment:"cytosol"},{id:5,label:"CD79",type:"prot",compartment:"membrane"},{id:6,label:"SYK",type:"prot",compartment:"cytosol"},{id:7,label:"IRAK4",type:"prot",compartment:"cytosol"},{id:8,label:"BCL6",type:"prot",compartment:"cytosol"},{id:9,label:"NFKB Path",type:"pathway",compartment:"cytosol"},{id:10,label:"Ca2+ Rel",type:"event",compartment:"membrane"},{id:11,label:"BTK",type:"prot",compartment:"cytosol"},{id:12,label:"CARD11",type:"prot",compartment:"cytosol"},{id:13,label:"JAK2",type:"prot",compartment:"cytosol"},{id:14,label:"STAT3",type:"prot",compartment:"cytosol"},{id:15,label:"Cell Survival",type:"event",compartment:"nucleus"}],links:[{source:0,target:1,type:"activate"},{source:1,target:2,type:"activate"},{source:2,target:3,type:"activate"},{source:4,target:0,type:"inhibit"},{source:4,target:5,type:"inhibit"},{source:4,target:6,type:"activate"},{source:6,target:11,type:"activate"},{source:11,target:10,type:"activate"},{source:10,target:12,type:"activate"},{source:12,target:9,type:"activate"},{source:13,target:14,type:"activate"},{source:14,target:15,type:"activate"},{source:7,target:9,type:"activate"},{source:8,target:3,type:"activate"},{source:9,target:15,type:"activate"},{source:9,target:3,type:"activate"}]}};return{pathway:function(){return a}}}),angular.module("phosphoBaseApp").filter("reverse",function(){function a(a){var b,c=[];if(a)if(angular.isArray(a))c=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}return function(b){return a(b).slice().reverse()}}),angular.module("phosphoBaseApp").controller("NavbarCtrl",["$scope","$rootScope","$firebaseSimpleLogin","$modal",function(a,b,c,d){b.auth={newAccount:!1};var e=new Firebase("https://phosphobase.firebaseio.com"),f=c(e);b.$on("$firebaseSimpleLogin:login",function(a,c){b.auth.user=c}),b.$on("$firebaseSimpleLogin:logout",function(){b.auth.user=null}),b.auth.email="test@phospho.io",b.auth.password="test123",b.loginModal=function(){a.modalInstance=d.open({templateUrl:"views/login-modal.html"})},b.fbLogin=function(){f.$login("password",{email:b.auth.email,password:b.auth.password}),a.modalInstance.close()},b.signup=function(){f.$createUser(b.auth.email,b.auth.password).then(function(a){console.log("Created account and logged in as: ",a.uid)},function(a){console.log("login failed: ",a)})},b.logout=function(){f.$logout()},a.authDropdown={choices:[{text:"View/Edit Profile",action:"viewProfile"},{text:"Log Out",action:"logout"}]},a.authDropdown.select=function(a){"viewProfile"===a?d.open({templateUrl:"views/profile-modal.html"}):"logout"===a&&f.$logout()}}]);