<div class="first-column">
  <!-- Alerts -->
  <alert ng-repeat="alert in alerts" type="alert.type" close="closeAlert($index)">{{alert.msg}}</alert>

  <!-- Main sidebar panel -->
  <div class="panel panel-default">
    <ul class="list-group">

      <!-- Consume or Contribute item -->
      <li class="list-group-item figure-sidebar-item">
        <ul class="nav nav-pills nav-justified">

          <!-- Close Modal (and go back to grid view) -->
          <li ng-click="$close()"><a href=""><i class="fa fa-eject fa-fw"></i> Close </a></li>

          <!-- Download resource item as static file -->
          <li><a href="">
            <i class="fa fa-floppy-o fa-fw"></i> Download 
          </a></li>

          <!-- Push to back-end resource (contextual for mutable items) -->
          <li ng-click="publish(selectedFigure)" ng-if="selectedFigure.mutable"><a href="">
            <i class="fa fa-camera-retro fa-fw"></i> Publish 
          </a></li>

          <!-- Fork back-end resource (contextual for immutable items) -->
          <li ng-click="fork(selectedFigure)" ng-if="!selectedFigure.mutable"><a href="">
            <i class="fa fa-code-fork fa-fw"></i> Fork 
          </a></li>
        </ul>
      </li>

      <!-- Add a flask to this figure -->
      <li class="list-group-item figure-sidebar-item" ng-if="!selectedFigure.mutable">
        <button type="button" class="btn btn-default" ng-click="addFlask()" ng-if="!selectedFigure.userFlasked">Flask Me!</button>
        <span ng-if="selectedFigure.userFlasked">You've let the community know that this figure is helpful by flasking it.</span>
      </li>

      <li class="list-group-item figure-sidebar-item" ng-if="!auth.user">
        <!-- Log-In Reminder -->
        <button type="button" class="btn btn-success btn-block" ng-click="$close(); loginModal();"><i class="fa fa-user fa-fw"></i> Log In or Create an Account</button>
      </li>

    </ul>

  </div>

  <!-- Contextual Panel for Viewing/Editing selection from Graph -->
  <div ng-if="selectedGraphItem">
    <div ng-switch on="selectedGraphItem.type">
      <div class="panel panel-default">
        <ul class="list-group">

          <!-- When a node is selected -->
          <div ng-switch-when="node">

            <!-- Edit the node if figure is mutable -->
            <div ng-if="selectedFigure.mutable">
              <li class="list-group-item">
                <strong class="list-group-item-heading">Label</strong><br>
                <input type="text" size="14" ng-model="selectedGraphItem.graphItem.label">
              </li>
              <li class="list-group-item">
                <strong class="list-group-item-heading">Type</strong><br>
                  <input type="radio" ng-model="selectedGraphItem.graphItem.type" value="prot">  Protein <br/>
                  <input type="radio" ng-model="selectedGraphItem.graphItem.type" value="event"> Event <br/>
                  <input type="radio" ng-model="selectedGraphItem.graphItem.type" value="pathway"> Pathway <br/>
              </li>
              <li class="list-group-item">
                <strong class="list-group-item-heading">Compartment</strong><br>
                <input type="radio" ng-model="selectedGraphItem.graphItem.compartment" value="membrane">  membrane <br/>
                <input type="radio" ng-model="selectedGraphItem.graphItem.compartment" value="cytosol">  cytosol <br/>
                <input type="radio" ng-model="selectedGraphItem.graphItem.compartment" value="nucleus">  nucleus <br/>
              </li>
              <li class="list-group-item">
                <div class="btn-group">
                  <button type="button" class="btn btn-default" ng-click="deselectGraphItem()">okay</button>
                  <button type="button" class="btn btn-default" ng-click="spliceNode()">delete</button>
                </div>
              </li>
            </div>
            
            <!-- View the node if figure is immutable -->
            <div ng-if="!selectedFigure.mutable">
              you selected {{selectedGraphItem.graphItem.label}}
            </div>
          </div>

          <!-- When a link is selected -->
          <div ng-switch-when="link">
            <!-- Edit the link if figure is mutable -->
            <div ng-if="selectedFigure.mutable">

              <li class="list-group-item">
                <strong class="list-group-item-heading">Source</strong><br>
                <select ng-model="selectedGraphItem.graphItem.source" ng-options="n.id as n.label for n in selectedFigure.graph.nodes"></select>
              </li>
              <li class="list-group-item">
                <strong class="list-group-item-heading">Target</strong><br>
                <select ng-model="selectedGraphItem.graphItem.target" ng-options="n.id as n.label for n in selectedFigure.graph.nodes"></select>
              </li>
              <li class="list-group-item">
                <strong class="list-group-item-heading">Type</strong><br>
                  <input type="radio" ng-model="selectedGraphItem.graphItem.type" value="activate">  activate <br/>
                  <input type="radio" ng-model="selectedGraphItem.graphItem.type" value="inhibit">  inhibit <br/>
              </li>
              <li class="list-group-item">
                <div class="btn-group">
                  <button type="button" class="btn btn-default" ng-click="deselectGraphItem()">okay</button>
                  <button type="button" class="btn btn-default" ng-click="spliceLink()">delete</button>
                </div>
              </li>
            </div>
          </div>

        </ul>
      </div>
    </div>
  </div>

  <!-- Editing Sidebar panel (contextual for mutable figs) -->
  <div class="panel panel-default" ng-if="selectedFigure.mutable && selectedGraphItem === null">
    <div class="panel-body">
      <div class="input-group">
        <span class="input-group-addon">Title</span>
        <input class="form-control" type="text" ng-model="selectedFigure.title" ng-change="selectedFigure.hasTitle = true;">
      </div>
    </div>
    <accordion close-others="true">
      <accordion-group is-open="pathway">
        <accordion-heading>
          <i class="fa fa-pencil fa-fw"></i> Edit Pathway <i class="fa pull-right" ng-class="{'fa-minus-square': pathway, 'fa-plus-square': !pathway}"></i>
        </accordion-heading>
        <ul class="nav nav-pills nav-stacked">
          <li><a><i class="fa fa-anchor fa-fw"></i> Load Template </a></li>
          <li ng-click="addNode()"><a><i class="fa fa-plus-circle fa-fw"></i> Add Node </a></li>
          <li ng-click="addLink()"><a><i class="fa fa-plus-circle fa-fw"></i> Add Link </a></li>
        </ul>
      </accordion-group>
      <accordion-group  is-open="biology">
        <accordion-heading>
          <i class="fa fa-bar-chart-o fa-fw"></i> Bind Data <i class="fa pull-right" ng-class="{'fa-minus-square': biology, 'fa-plus-square': !biology}"></i>
        </accordion-heading>
        <ul class="nav nav-pills nav-stacked">
          <li><a href=""><i class="fa fa-floppy-o fa-fw"></i> Import Files</a></li>
          <li><a href=""><i class="fa fa-list-alt fa-fw"></i> Lay Out Conditions</a></li>
          <li><a href=""><i class="fa fa-signal fa-fw"></i> Scale and Preprocess </a></li>      
        </ul>
      </accordion-group>
      <accordion-group is-open="tags">
        <accordion-heading>
          <i class="fa fa-tags fa-fw"></i> Add/Edit Tags <i class="fa pull-right" ng-class="{'fa-minus-square': tags, 'fa-plus-square': !tags}"></i>
        </accordion-heading>
      <input type="text" ui-select2="select2Options" ng-model="selectedFigure.tags">
      </accordion-group>
    </accordian>
  </div>

</div>

<div class="second-column">
  <!-- Main Figure Visualization -->
  <div class="panel panel-primary panel-focus">
    <div class="panel-heading">
      <h3 class="panel-title">{{selectedFigure.title}}</h3>

    </div>
    <div phos-pathway graph="selectedFigure.graph" mutable="selectedFigure.mutable" scale="1" select-item="selectGraphItem(item)"></div>
  </div>
</div>

  